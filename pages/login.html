<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no,email=no,address=no">
  <title>Entrar ‚Äî LUMARI</title>
  <meta name="description" content="Fa√ßa login para acessar feeds personalizados ou painel do criador na LUMARI.">
  <meta name="theme-color" content="#7c4dff">
  <link rel="icon" href="../logo/logo.jpg">
  <link rel="stylesheet" href="../css/styles.css">
  <style>
    .auth-wrapper{min-height:60vh;display:grid;place-items:center;padding:20px}
    .auth-card{width:100%;max-width:460px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);border:1px solid rgba(255,255,255,0.07);box-shadow:0 8px 40px rgba(6,3,12,0.6);border-radius:16px;padding:20px}
    .auth-title{display:flex;align-items:center;gap:10px;margin-bottom:6px}
    .auth-title img{height:28px;width:28px;border-radius:6px}
    .auth-sub{color:var(--muted);font-size:14px;margin-bottom:16px}
    .form-field{display:flex;flex-direction:column;gap:6px;margin-top:12px}
    .form-field label{font-size:14px;color:#ddd}
    .form-field input{padding:12px 14px;background:rgba(255,255,255,0.06);border:1px solid rgba(255,255,255,0.16);border-radius:10px;color:#fff;outline:none;transition:all .25s}
    .form-field input:focus{border-color:rgba(124,77,255,0.6);box-shadow:0 0 0 3px rgba(124,77,255,0.15)}
    .btn{margin-top:16px;padding:12px 16px;border-radius:12px;border:1px solid rgba(124,77,255,0.4);background:linear-gradient(180deg,rgba(124,77,255,0.3),rgba(94,60,255,0.18));color:#fff;cursor:pointer;transition:transform .08s ease, filter .2s}
    .btn:hover{filter:brightness(1.05)}
    .btn:active{transform:scale(.98)}
    .auth-footer{margin-top:12px;text-align:center}
    .auth-footer a{color:var(--accent)}
  </style>
</head>
<body>
  <a href="#main" class="skip-link">Pular para conte√∫do</a>
  <header class="topbar" role="banner" aria-label="Barra de navega√ß√£o">
    <div class="topbar-inner">
      <a href="../index.html" class="brand-mini" aria-label="LUMARI home">
        <img src="../logo/logo.jpg" alt="LUMARI" class="logo-mini">
      </a>
  <nav class="nav" role="navigation" aria-label="Menu principal">
    <a href="about.html">Quem somos?</a>
  <a href="features.html">Funcionalidades</a>
  <a href="credits.html">Cr√©ditos</a>
  </nav>
    </div>
  </header>

  <button id="audioToggle" class="audio-toggle" aria-pressed="false" aria-label="Ativar som">üîä</button>

  <main id="main" class="container">
    <section class="auth-wrapper intro">
      <div class="auth-card">
        <div class="auth-title">
          <img src="../logo/logo.jpg" alt="LUMARI">
          <h1>Entrar</h1>
        </div>
        <p class="auth-sub">Acesse sua conta para continuar.</p>
        <form id="loginForm">
          <div class="form-field">
            <label for="email">E-mail</label>
            <input type="email" id="email" name="email" required placeholder="voce@email.com">
          </div>
          <div class="form-field">
            <label for="password">Senha</label>
            <input type="password" id="password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
          </div>
          <button type="submit" class="btn">Entrar</button>
        </form>
        <div class="auth-footer">
          <a href="signup.html" id="signupLink">N√£o possui conta? Criar agora</a>
        </div>
      </div>
    </section>
  </main>

  <script defer src="../js/main.js"></script>
  <script>
    // Auth simples: valida contra localStorage.lumari_users e cria sess√£o
    (function(){
      const form = document.getElementById('loginForm');
      const signupLink = document.getElementById('signupLink');
      const params = new URLSearchParams(location.search);
      const role = params.get('role') === 'creator' ? 'creator' : 'public';
      // Ajusta o link de signup para preservar a role desejada
      signupLink.href = 'signup.html?role=' + role;

      // som de clique expl√≠cito no submit
      form.addEventListener('submit', function(ev){
        ev.preventDefault();
        try{ if(window.lumariPlayClick) window.lumariPlayClick(); }catch(e){}
        const email = (document.getElementById('email').value||'').trim();
        const password = (document.getElementById('password').value||'').trim();
        if(!email || !password){ return; }
        let db = [];
        try{ db = JSON.parse(localStorage.getItem('lumari_users')||'[]'); }catch(e){ db = []; }
        const found = db.find(u => String(u.email).toLowerCase() === String(email).toLowerCase());
        if(!found){ alert('Conta n√£o encontrada. Crie sua conta.'); return; }
        if(String(found.password) !== String(password)){ alert('Senha incorreta.'); return; }
        if(found.role !== role){
          alert('Este e-mail est√° cadastrado como "' + (found.role==='creator'?'Criador de Conte√∫do':'P√∫blico Geral') + '". Use a op√ß√£o de acesso correspondente.');
          return;
        }
        const sessionUser = { email: found.email, name: found.name, role: found.role };
        try{ localStorage.setItem('lumari_user', JSON.stringify(sessionUser)); }catch(e){}
  // For√ßar fluxo de humor di√°rio no p√∫blico: usar force=1 para ignorar autoredireciono por √∫ltima emo√ß√£o
  const target = role === 'creator' ? 'home-creator.html' : 'home-public.html?force=1';
        // Preferir PJAX para manter √°udio cont√≠nuo
        try{
          if(typeof window.pjaxLoad === 'function'){
            window.pjaxLoad(target, true);
          } else {
            window.location.href = target;
          }
        }catch(_){ window.location.href = target; }
      });

      // clique sonoro no link de cadastro
      if(signupLink){ signupLink.addEventListener('click', function(){ try{ if(window.lumariPlayClick) window.lumariPlayClick(); }catch(e){} }); }
    })();
  </script>
</body>
</html>
